<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MinecraftæœåŠ¡å™¨çŠ¶æ€æŸ¥è¯¢</title>
    <style>
        /* CSSå˜é‡å®šä¹‰ */
        :root {
            --bg-color: #f5f5f5;
            --text-color: #333;
            --container-bg: white;
            --container-shadow: 0 2px 10px rgba(0,0,0,0.1);
            --status-bg: #f9f9f9;
            --border-color: #eee;
            --address-color: #666;
            --players-bg: #e8f5e9;
            --online-color: #4CAF50;
            --offline-color: #f44336;
            --error-color: #f44336;
            --loading-color: #2196F3;
            --toggle-bg: rgba(255, 255, 255, 0.8);
            --toggle-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }
        
        /* æ·±è‰²æ¨¡å¼å˜é‡ */
        body.dark-mode {
            --bg-color: #242424;
            --text-color: #e0e0e0;
            --container-bg: #333333;
            --container-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
            --status-bg: #404040;
            --border-color: #555555;
            --address-color: #b0b0b0;
            --players-bg: #2a4339;
            --error-color: #ef5350;
            --loading-color: #64b5f6;
            --toggle-bg: rgba(60, 60, 60, 0.8);
            --toggle-shadow: 0 2px 5px rgba(255, 255, 255, 0.1);
            --toggle-text-color: #ffffff;
        }
        
        /* åŸºç¡€æ ·å¼é‡ç½® */
        * {
            box-sizing: border-box;
        }
        
        /* å…¨å±€æ ·å¼ */
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: var(--bg-color);
            color: var(--text-color);
            text-align: center;
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        
        /* æ ‡é¢˜æ ·å¼ */
        h1, h2 {
            margin-bottom: 20px;
        }
        
        h1 {
            color: var(--text-color);
        }
        
        /* ä¸»å®¹å™¨æ ·å¼ */
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: var(--container-bg);
            padding: 20px;
            border-radius: 8px;
            box-shadow: var(--container-shadow);
            transition: background-color 0.3s ease, box-shadow 0.3s ease;
        }
        
        /* æœåŠ¡å™¨çŠ¶æ€å®¹å™¨æ ·å¼ */
        #server-status {
            margin: 20px 0;
            padding: 20px;
            border-radius: 8px;
            background-color: var(--status-bg);
            transition: background-color 0.3s ease;
            display: flex;
            flex-direction: column;
            gap: 16px;
        }
        
        /* é”™è¯¯ä¿¡æ¯æ ·å¼ */
        .error {
            color: var(--error-color);
            font-weight: bold;
            transition: color 0.3s ease;
        }
        
        /* åŠ è½½çŠ¶æ€æ ·å¼ */
        .loading {
            color: var(--loading-color);
            font-style: italic;
            transition: color 0.3s ease;
        }
        
        /* ä¸»é¢˜åˆ‡æ¢æŒ‰é’®æ ·å¼ */
        #theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            font-size: 24px;
            cursor: pointer;
            padding: 10px;
            border-radius: 50%;
            background-color: var(--toggle-bg);
            color: var(--text-color);
            box-shadow: var(--toggle-shadow);
            transition: all 0.3s ease;
            z-index: 1000;
            border: none;
            outline: none;
        }
        
        #theme-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.3);
        }
        
        body.dark-mode #theme-toggle {
            color: var(--toggle-text-color);
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                padding: 15px;
            }
            
            #theme-toggle {
                top: 10px;
                right: 10px;
                font-size: 20px;
                padding: 8px;
            }
            
            h1 {
                font-size: 24px;
            }
            
            .online-content-wrapper {
                padding: 15px;
            }
            
            .icon-container {
                margin-right: 12px;
            }
            
            .server-icon {
                width: 48px;
                height: 48px;
            }
            
            .motd-display {
                font-size: 14px;
            }
            
            .info-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }
            
            .info-label {
                font-size: 11px;
            }
            
            .info-value {
                font-size: 13px;
            }
            
            .player-count {
                font-size: 13px;
            }
        }
        
        @media (max-width: 480px) {
            .online-content-wrapper {
                flex-direction: column;
                align-items: center;
                text-align: center;
            }
            
            .icon-container {
                margin-right: 0;
                margin-bottom: 12px;
            }
            
            .card-header {
                flex-direction: column;
                align-items: center;
                gap: 8px;
            }
            
            .info-grid {
                grid-template-columns: 1fr;
            }
        }
        
        /* å¡ç‰‡å¼è®¾è®¡ */
        .card {
            position: relative;
            border-radius: 12px;
            overflow: hidden;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        
        .card:hover {
            transform: translateY(-2px);
        }
        
        .status-card {
            background-color: var(--container-bg);
            border-radius: 12px;
            box-shadow: var(--container-shadow);
            transition: background-color 0.3s ease, box-shadow 0.3s ease;
        }
        
        .is-clickable {
            cursor: pointer;
        }
        
        .online-content-wrapper {
            display: flex;
            padding: 20px;
            align-items: flex-start;
        }
        
        .icon-container {
            margin-right: 16px;
            flex-shrink: 0;
        }
        
        .server-icon {
            width: 64px;
            height: 64px;
            border-radius: 8px;
            object-fit: cover;
        }
        
        .main-content {
            flex: 1;
            min-width: 0;
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }
        
        .motd-display {
            font-size: 16px;
            font-weight: bold;
            line-height: 1.4;
            margin-bottom: 8px;
        }
        
        .status-indicator {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            line-height: 1;
            min-height: 24px;
            min-width: 60px;
            white-space: nowrap;
            color: white;
        }
        
        .status-indicator.Java {
            background-color: #1D9BF0;
        }
        
        /* ä¸ºä¸åŒçŠ¶æ€çš„æŒ‡ç¤ºå™¨è®¾ç½®åˆé€‚çš„èƒŒæ™¯è‰²å’Œæ–‡æœ¬é¢œè‰² */
        .status-indicator.online {
            background-color: var(--online-color);
        }
        
        .status-indicator.offline, .status-indicator.error {
            background-color: var(--offline-color);
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 12px;
            margin-bottom: 16px;
        }
        
        .info-item {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }
        
        .info-label {
            font-size: 12px;
            color: #888;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .info-value {
            font-size: 14px;
            font-weight: 500;
            color: var(--text-color);
            transition: color 0.3s ease;
        }
        
        .info-value.version {
            color: #4CAF50;
        }
        
        .players-sample {
            font-style: italic;
            color: #888;
        }
        
        .players-info {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .player-count {
            font-size: 14px;
            font-weight: 500;
        }
        
        .progress-bar {
            height: 8px;
            background-color: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
            transition: background-color 0.3s ease;
        }
        
        .progress-bar-inner {
            height: 100%;
            background-color: var(--online-color);
            transition: width 0.3s ease;
        }
        
        /* æ·±è‰²æ¨¡å¼ä¸‹çš„é¢å¤–æ ·å¼ */
        body.dark-mode .progress-bar {
            background-color: #444;
        }
        
        /* åŠ è½½åŠ¨ç”» */
        @keyframes pulse {
            0% { opacity: 0.6; }
            50% { opacity: 1; }
            100% { opacity: 0.6; }
        }
        
        .loading {
            animation: pulse 1.5s infinite;
        }
    </style>
</head>
<body>
    <button id="theme-toggle" aria-label="åˆ‡æ¢ä¸»é¢˜">ğŸŒ™</button>
    <main class="container">
        <h1>MinecraftæœåŠ¡å™¨çŠ¶æ€æŸ¥è¯¢</h1>
        <section id="server-status">
            <div class="loading">æ­£åœ¨æŸ¥è¯¢æœåŠ¡å™¨çŠ¶æ€...</div>
        </section>
    </main>

    <script>
        // åº”ç”¨é…ç½®å’Œå¸¸é‡
        const CONFIG = {
            // æœåŠ¡å™¨åˆ—è¡¨é…ç½®
            SERVERS: [
                { ip: 's6.ungc.com.cn', port: '15120', name: 'ç«¥è¯é•‡' },
                { ip: 'mc.fnzjaq.me', port: '25565', name: 'ä½ ä¹Ÿæ¥ğŸ±ğŸŸä¹ˆ' },
                { ip: 'okkmc.cn', port: '32230', name: 'OKKMC' }
            ],
            // APIåŸºç¡€URL
            API_BASE: 'https://motd.minebbs.com/api/status',
            // ç¼“å­˜æŒç»­æ—¶é—´ (æ¯«ç§’)
            CACHE_DURATION: 60 * 1000, // 1åˆ†é’Ÿç¼“å­˜
            // è‡ªåŠ¨åˆ·æ–°é—´éš” (æ¯«ç§’)
            AUTO_REFRESH_INTERVAL: 30 * 1000, // 30ç§’è‡ªåŠ¨åˆ·æ–°
            // APIè¯·æ±‚æœ€å¤§é‡è¯•æ¬¡æ•°
            MAX_RETRIES: 3 // æœ€å¤§é‡è¯•æ¬¡æ•°
        };

        // DOMå…ƒç´ å¼•ç”¨
        const themeToggle = document.getElementById('theme-toggle');
        const serverStatusSection = document.getElementById('server-status');
        
        // é»˜è®¤æœåŠ¡å™¨å›¾æ ‡ (Base64ç¼–ç )
        const DEFAULT_SERVER_ICON = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAEsElEQVR4Xu2avU+TURSHS41QIjBonEAWSEp0MZBA/Qt0gkI/EhdHiZ1bYGtYgbDJQHR1cjFhNnEAJif+oMo97e/2x+G8H7TUQHvf5Bnec7/e8/Te+35AJnP7aA05iYduMGxEHlJhWI/z83MBearc5RhZAWbizWbTs7a2dicKhYKg43Gsrq4KOt4PSNqBXCqVisAiggAWYCW9sbFhsr6+LhSLRUGXIx5XpuN3QfeB68E5/4hIvFqtCkFAEBAhAEmjM8fu7q6Ajnd2doSDgwNhb29PODw8FFCOdnGgrY6jDwvdFuMirkU5sBck7gFBgCEARCWOc1wAzo+Ojjy4yChQD211uVVXS0O5JQLHQAX8+FoSogSgXCf0IAVwYySKgfVURBwJctJ80XECdOJanlVXzzi9JCwBqTfBIIAao0MMGCXgZP+D8PfXRw/quAuDANRzWOU455gbDzGdOPfBWAJ6WgIjLwAJR01JYAnARTosAWgbtUQQc+VauD5HG1yvJaCnJZBWQLO2IrAATtaKWVjtrYT1+b0IwFsZN0bHGFCDKTdIAW58PeUBrk9vhpaAxCXQj4DK5pqAaevgZKwYpLE4jvGy+C8CrCWgB4qagoMWoEm6LktA4hIIAjoCrEdgDOSmWbO2fAtMwcpmwcMydKJRyXIMcILlhace/gHSCEi9BIKAURcQtwfwbsy3LyTAAjgJ1OMYy0B5a/ZNl7k2jaWMp7Q46fk281JIuwcEAf0IQOJukOp1chokxdO+Uix4LAEMpLU+feky+1rYWsx5zl7MeyxBWLK8jIOAfgSgw8ciIG4JpH4OSBIwfzoraAkOa1/g3Z3XcGMp60FS9XzG0zr53oaldJJmuJ+BCeBN8LEKKJfLQhBwFwHWJrj8+63Aa3j+dE7QaxtACt/mWIZOylG/XtMOjll7QGlyxoMfjP8yFQSkFYDvAdwYAjDtHSvXyTsgwpH5nBV+vst4+KEISZ89f+XZWhj3WFPcL4vrqQ3Ons97vIDctAcCeloCQYDxReixCYjbBBMfhOIEZIqZLttPhKvalKf1Z1e4qj3zsAwk7Xd2TeehxxLAuzzvK6XxKcHtS7hLBQH9CIi7C2S3sx6I4ARbxxNtOiKE45ynns8KN972GJU008iPefjZAncWd3cKAkZZAK7RARGWgMS7QJwAfHBwnUMAX1i9A+8LV7VpT+t4UtiamPHoRDWNpTGBH7V5D8DHFJYyMAHo2El4yAIGtgRGXgCesPCnJ7wbIA4aeSemDaS0xXRlgNJEl3KuDX/csN4wsRT1n8v1UrUE9PQ9YCQF8LuAHhCJW0uDQRxlvFyAbsttNBB8sv/ew4mjHs57ehsMAowlgIFxkTjHQBCik0EcZTp5FqD7sMB4LMD9ILocX4KtJdDTJnhfAjjRqLhO2hKAupiRuvxeBPA3dXSCAZAgzvVmBEGIWxuVrhsV5zI9rk5c/2BBQC8CLi4uBP5Xc+7IAhuNFpYG3dZCt9HwZudAnA/kkrgJBgGjKuDy8lJARTwxOfC/9o/t4B8RuQQBhgAcEsAuyQIQQ2PdGdflOKP7wLkeT9fj/qPqpgFtrMRxjLwAHFxpGEk8dINh48bxD72QHUXzXPQqAAAAAElFTkSuQmCC';

        // ç¼“å­˜ç®¡ç†
        const cache = {
            data: {},
            
            get(key) {
                const item = this.data[key];
                if (!item) return null;
                if (Date.now() - item.timestamp > CONFIG.CACHE_DURATION) {
                    delete this.data[key];
                    return null;
                }
                return item.value;
            },
            
            set(key, value) {
                this.data[key] = { value, timestamp: Date.now() };
            },
            
            // æ¸…é™¤è¿‡æœŸç¼“å­˜
            clearExpired() {
                const now = Date.now();
                Object.keys(this.data).forEach(key => {
                    if (now - this.data[key].timestamp > CONFIG.CACHE_DURATION) {
                        delete this.data[key];
                    }
                });
            }
        };

        // ä¸»é¢˜åˆ‡æ¢åŠŸèƒ½
        function initThemeToggle() {
            // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–ä¸»é¢˜
            const isDarkMode = localStorage.getItem('darkMode') === 'true';
            if (isDarkMode) {
                document.body.classList.add('dark-mode');
                themeToggle.textContent = 'â˜€ï¸';
            }

            // æ·»åŠ ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨
            themeToggle.addEventListener('click', () => {
                const isDarkMode = document.body.classList.toggle('dark-mode');
                themeToggle.textContent = isDarkMode ? 'â˜€ï¸' : 'ğŸŒ™';
                localStorage.setItem('darkMode', isDarkMode);
            });
        }

        // è½¬æ¢Minecrafté¢œè‰²ä»£ç ä¸ºHTML
        function convertMinecraftColors(motd) {
            if (!motd) return '';
            
            // æå–MOTDæ–‡æœ¬
            let motdText = '';
            if (typeof motd === 'object' && motd !== null) {
                if (motd.text) {
                    motdText = motd.text;
                } else if (motd.extra && Array.isArray(motd.extra)) {
                    // å¤„ç†å¸¦æœ‰extraå­—æ®µçš„å¤æ‚JSONç»“æ„
                    motdText = motd.extra.map(part => 
                        typeof part === 'object' && part.text ? part.text : String(part)
                    ).join('');
                } else {
                    motdText = JSON.stringify(motd);
                }
            } else {
                motdText = String(motd);
            }
            
            // é¢œè‰²ä»£ç æ˜ å°„
            const colorMap = {
                '0': '#000000', '1': '#0000AA', '2': '#00AA00', '3': '#00AAAA',
                '4': '#AA0000', '5': '#AA00AA', '6': '#FFAA00', '7': '#AAAAAA',
                '8': '#555555', '9': '#5555FF', 'a': '#55FF55', 'b': '#55FFFF',
                'c': '#FF5555', 'd': '#FF55FF', 'e': '#FFFF55', 'f': '#FFFFFF'
            };
            
            // æ ¼å¼ä»£ç æ˜ å°„
            const formatMap = {
                'l': 'font-weight: bold;',
                'm': 'text-decoration: line-through;',
                'n': 'text-decoration: underline;',
                'o': 'font-style: italic;'
            };
            
            // æµ…è‰²æ–‡æœ¬åˆ—è¡¨ï¼ˆåœ¨ç™½è‰²èƒŒæ™¯ä¸Šéœ€è¦æ·±è‰²é˜´å½±ï¼‰
            const lightColors = ['7', 'e', 'f'];
            
            // å¤„ç†é¢œè‰²ä»£ç 
            return motdText.replace(/Â§([0-9a-frlmno])/g, (match, code) => {
                if (code === 'r') return '</span>';
                if (colorMap[code]) {
                    const style = lightColors.includes(code) 
                        ? `color: ${colorMap[code]}; text-shadow: 0 0 2px #000000, 0 0 2px #000000;`
                        : `color: ${colorMap[code]};`;
                    return `<span style="${style}">`;
                }
                return formatMap[code] ? `<span style="${formatMap[code]}">` : match;
            });
        }

        // è·å–æœåŠ¡å™¨åœ°å€æ˜¾ç¤ºæ–‡æœ¬
        function getServerAddressDisplay(ip, port) {
            return port === '25565' ? ip : `${ip}:${port}`;
        }

        // æ ¼å¼åŒ–ç©å®¶åˆ—è¡¨æ˜¾ç¤º
        function getPlayerListDisplay(players) {
            if (!players || players.online === 0) {
                return 'æ— ';
            }

            const playerList = players.sample;
            
            if (!playerList || typeof playerList !== 'string') {
                return `æœ‰ ${players.online} åç©å®¶åœ¨çº¿ï¼Œä½†æœªè¿”å›å…·ä½“åˆ—è¡¨`;
            }

            // å¤„ç†å­—ç¬¦ä¸²æ ¼å¼çš„ç©å®¶åˆ—è¡¨
            const playerNames = playerList.split(',').map(name => name.trim()).filter(Boolean);
            if (playerNames.length === 0) {
                return `æœ‰ ${players.online} åç©å®¶åœ¨çº¿ï¼Œä½†æœªè¿”å›å…·ä½“åˆ—è¡¨`;
            }
            
            // ç»Ÿè®¡åŒ¿åç©å®¶æ•°é‡å¹¶è¿‡æ»¤
            const anonymousCount = playerNames.filter(name => name === 'Anonymous Player').length;
            const namedPlayers = playerNames.filter(name => name !== 'Anonymous Player');
            
            let result = namedPlayers.join(', ');
            
            // å¦‚æœæœ‰åŒ¿åç©å®¶ï¼Œæ·»åŠ åˆ°ç»“æœæœ«å°¾
            if (anonymousCount > 0) {
                result = namedPlayers.length > 0 
                    ? `${result},ç­‰ ${anonymousCount} åç©å®¶`
                    : `æœ‰ ${anonymousCount} ååŒ¿åç©å®¶åœ¨çº¿`;
            }
            
            return result;
        }

        // æå–MOTDå†…å®¹
        // å°è¯•ä»å¤šä¸ªå¯èƒ½çš„å­—æ®µä¸­æå–MOTDä¿¡æ¯ï¼Œä¼˜å…ˆé¡ºåºä¸ºï¼šdescription > motd > rawMotd > pureMotd > htmlMotd
        // å¦‚æœæ‰€æœ‰å­—æ®µéƒ½ä¸å­˜åœ¨ï¼Œåˆ™è¿”å›æœåŠ¡å™¨åç§°
        function extractMOTD(data, serverName) {
            // æŒ‰ä¼˜å…ˆçº§é¡ºåºæ£€æŸ¥å¯èƒ½åŒ…å«MOTDçš„å­—æ®µ
            const motdFields = ['description', 'motd', 'rawMotd', 'pureMotd', 'htmlMotd'];
            
            for (const field of motdFields) {
                if (data.hasOwnProperty(field)) {
                    return convertMinecraftColors(data[field]);
                }
            }
            
            // å¦‚æœæ²¡æœ‰æ‰¾åˆ°MOTDä¿¡æ¯ï¼Œè¿”å›æœåŠ¡å™¨åç§°
            return serverName;
        }

        // æŸ¥è¯¢å•ä¸ªæœåŠ¡å™¨çŠ¶æ€ï¼ˆå¸¦é‡è¯•æœºåˆ¶ï¼‰
        async function fetchServerStatus(server, retryCount = 0) {
            const cacheKey = `${server.ip}:${server.port}`;
            const cached = cache.get(cacheKey);
            
            if (cached) {
                return { ...cached, server };
            }

            try {
                const params = new URLSearchParams({
                    ip: server.ip,
                    port: server.port,
                    stype: 'auto',
                    string: encodeURIComponent('æœåŠ¡å™¨çŠ¶æ€')
                });
                
                const response = await fetch(`${CONFIG.API_BASE}?${params}`);
                
                if (!response.ok) {
                    throw new Error(`HTTPé”™è¯¯: ${response.status}`);
                }
                
                const data = await response.json();
                cache.set(cacheKey, data);
                return { ...data, server };
            } catch (error) {
                if (retryCount < CONFIG.MAX_RETRIES) {
                    // æŒ‡æ•°é€€é¿é‡è¯•
                    const delay = Math.pow(2, retryCount) * 1000;
                    await new Promise(resolve => setTimeout(resolve, delay));
                    return fetchServerStatus(server, retryCount + 1);
                }
                return { status: 'error', server, error: 'æ— æ³•è¿æ¥åˆ°æœåŠ¡å™¨' };
            }
        }

        // æŸ¥è¯¢æ‰€æœ‰æœåŠ¡å™¨çŠ¶æ€
        async function fetchAllServersStatus() {
            try {
                // æ¸…é™¤è¿‡æœŸç¼“å­˜
                cache.clearExpired();
                
                const results = await Promise.all(CONFIG.SERVERS.map(fetchServerStatus));
                displayServerStatus(results);
            } catch (error) {
                serverStatusSection.innerHTML = '<div class="error">æŸ¥è¯¢æœåŠ¡å™¨çŠ¶æ€å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•</div>';
            }
        }

        // ç”Ÿæˆåœ¨çº¿æœåŠ¡å™¨HTML
        function generateOnlineServerHTML(data, addressDisplay) {
            const { server, players, version, protocol, delay, ping } = data;
            
            // æå–å¹¶è½¬æ¢MOTD
            const serverMOTD = extractMOTD(data, server.name);
            
            // è®¡ç®—ç©å®¶è¿›åº¦æ¡ç™¾åˆ†æ¯”
            const progressPercentage = players.max > 0 ? Math.min((players.online / players.max) * 100, 100) : 0;
            
            // è·å–ç©å®¶åˆ—è¡¨æ˜¾ç¤º
            const playersDisplay = getPlayerListDisplay(players);
            
            return `
                <div class="card status-card is-clickable">
                    <div class="online-content-wrapper">
                        <div class="icon-container">
                            <img src="${server.icon || DEFAULT_SERVER_ICON}" alt="Server Icon" class="server-icon">
                        </div>
                        <div class="main-content">
                            <div class="card-header">
                                <div class="motd-display">${serverMOTD || server.name}</div>
                                <div class="status-indicator Java">
                                    Java
                                </div>
                            </div>
                            <div class="info-grid">
                                <div class="info-item">
                                    <span class="info-label">åœ°å€</span>
                                    <span class="info-value">${addressDisplay}</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">ç‰ˆæœ¬</span>
                                    <span class="info-value version">${version || 'æœªçŸ¥'}</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">åè®®</span>
                                    <span class="info-value">${protocol || 'æœªçŸ¥'}</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">å»¶è¿Ÿ</span>
                                    <span class="info-value">${delay || ping || 'æœªçŸ¥'}ms</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">åœ¨çº¿åˆ—è¡¨</span>
                                    <div class="info-value players-sample">${playersDisplay}</div>
                                </div>
                            </div>
                            <div class="players-info">
                                <div class="player-count">ç©å®¶: <strong>${players.online}</strong> / ${players.max}</div>
                                <div class="progress-bar">
                                    <div class="progress-bar-inner" style="width: ${progressPercentage}%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        // ç”Ÿæˆç¦»çº¿æœåŠ¡å™¨HTML
        function generateOfflineServerHTML(data, addressDisplay) {
            const { server } = data;
            const statusText = data.status === 'error' ? 'é”™è¯¯' : 'ç¦»çº¿';
            const statusValue = data.status === 'error' ? 'æŸ¥è¯¢å¤±è´¥' : 'ç¦»çº¿';
            
            return `
                <div class="card status-card">
                    <div class="online-content-wrapper">
                        <div class="icon-container">
                            <img src="${server.icon || DEFAULT_SERVER_ICON}" alt="Server Icon" class="server-icon">
                        </div>
                        <div class="main-content">
                            <div class="card-header">
                                <div class="motd-display">${server.name}</div>
                                <div class="status-indicator Java" style="background-color: var(--offline-color);">
                                    ${statusText}
                                </div>
                            </div>
                            <div class="info-grid">
                                <div class="info-item">
                                    <span class="info-label">åœ°å€</span>
                                    <span class="info-value">${addressDisplay}</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">çŠ¶æ€</span>
                                    <span class="info-value" style="color: var(--offline-color);">${statusValue}</span>
                                </div>
                            </div>
                            ${data.error ? `<div class="error" style="margin-top: 10px;">${data.error}</div>` : ''}
                        </div>
                    </div>
                </div>
            `;
        }
        
        // æ˜¾ç¤ºæœåŠ¡å™¨çŠ¶æ€
        function displayServerStatus(results) {
            let html = '';
            
            // æŒ‰åœ¨çº¿çŠ¶æ€åˆ†ç»„æœåŠ¡å™¨
            const onlineServers = results.filter(data => data.status === 'online');
            const offlineServers = results.filter(data => data.status !== 'online');
            
            // å…ˆæ˜¾ç¤ºåœ¨çº¿æœåŠ¡å™¨
            onlineServers.forEach(data => {
                const { server } = data;
                const { ip, port } = server;
                const addressDisplay = getServerAddressDisplay(ip, port);
                html += generateOnlineServerHTML(data, addressDisplay);
            });
            
            // å†æ˜¾ç¤ºç¦»çº¿æœåŠ¡å™¨
            offlineServers.forEach(data => {
                const { server } = data;
                const { ip, port } = server;
                const addressDisplay = getServerAddressDisplay(ip, port);
                html += generateOfflineServerHTML(data, addressDisplay);
            });
            
            serverStatusSection.innerHTML = html;
        }

        // åˆå§‹åŒ–åº”ç”¨
        // 1. åˆå§‹åŒ–ä¸»é¢˜åˆ‡æ¢åŠŸèƒ½
        // 2. æ˜¾ç¤ºåŠ è½½çŠ¶æ€
        // 3. é¦–æ¬¡æŸ¥è¯¢æ‰€æœ‰æœåŠ¡å™¨çŠ¶æ€
        // 4. è®¾ç½®è‡ªåŠ¨åˆ·æ–°å®šæ—¶å™¨
        function initApp() {
            initThemeToggle();
            serverStatusSection.innerHTML = '<div class="loading">æ­£åœ¨æŸ¥è¯¢æœåŠ¡å™¨çŠ¶æ€...</div>';
            fetchAllServersStatus();
            
            // è®¾ç½®è‡ªåŠ¨åˆ·æ–°å®šæ—¶å™¨ï¼Œæ¯30ç§’æ›´æ–°ä¸€æ¬¡æœåŠ¡å™¨çŠ¶æ€
            setInterval(fetchAllServersStatus, CONFIG.AUTO_REFRESH_INTERVAL);
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>

